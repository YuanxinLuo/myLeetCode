package com.luo.offer;

import java.util.ArrayList;
import java.util.List;

public class Offer51_60 {

    /**
     * å‰‘æŒ‡ Offer 52. ä¸¤ä¸ªé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹
     * è¾“å…¥ä¸¤ä¸ªé“¾è¡¨ï¼Œæ‰¾å‡ºå®ƒä»¬çš„ç¬¬ä¸€ä¸ªå…¬å…±èŠ‚ç‚¹ã€‚
     * <p>
     * å¦‚ä¸‹é¢çš„ä¸¤ä¸ªé“¾è¡¨ï¼š
     * åœ¨èŠ‚ç‚¹ c1 å¼€å§‹ç›¸äº¤ã€‚
     * ç¤ºä¾‹ 1ï¼š
     * è¾“å…¥ï¼šintersectVal = 8, listA = [4,1,8,4,5], listB = [5,0,1,8,4,5], skipA = 2, skipB = 3
     * è¾“å‡ºï¼šReference of the node with value = 8
     * è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º 8 ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º 0ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [4,1,8,4,5]ï¼Œé“¾è¡¨ B ä¸º [5,0,1,8,4,5]ã€‚åœ¨ A ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 2 ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 3 ä¸ªèŠ‚ç‚¹ã€‚
     * <p>
     * ç¤ºä¾‹ 2ï¼š
     * è¾“å…¥ï¼šintersectVal = 2, listA = [0,9,1,2,4], listB = [3,2,4], skipA = 3, skipB = 1
     * è¾“å‡ºï¼šReference of the node with value = 2
     * è¾“å…¥è§£é‡Šï¼šç›¸äº¤èŠ‚ç‚¹çš„å€¼ä¸º 2 ï¼ˆæ³¨æ„ï¼Œå¦‚æœä¸¤ä¸ªåˆ—è¡¨ç›¸äº¤åˆ™ä¸èƒ½ä¸º 0ï¼‰ã€‚ä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [0,9,1,2,4]ï¼Œé“¾è¡¨ B ä¸º [3,2,4]ã€‚åœ¨ A ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 3 ä¸ªèŠ‚ç‚¹ï¼›åœ¨ B ä¸­ï¼Œç›¸äº¤èŠ‚ç‚¹å‰æœ‰ 1 ä¸ªèŠ‚ç‚¹ã€‚
     * <p>
     * ç¤ºä¾‹ 3ï¼š
     * è¾“å…¥ï¼šintersectVal = 0, listA = [2,6,4], listB = [1,5], skipA = 3, skipB = 2
     * è¾“å‡ºï¼šnull
     * è¾“å…¥è§£é‡Šï¼šä»å„è‡ªçš„è¡¨å¤´å¼€å§‹ç®—èµ·ï¼Œé“¾è¡¨ A ä¸º [2,6,4]ï¼Œé“¾è¡¨ B ä¸º [1,5]ã€‚ç”±äºè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œæ‰€ä»¥ intersectVal å¿…é¡»ä¸º 0ï¼Œè€Œ skipA å’Œ skipB å¯ä»¥æ˜¯ä»»æ„å€¼ã€‚
     * è§£é‡Šï¼šè¿™ä¸¤ä¸ªé“¾è¡¨ä¸ç›¸äº¤ï¼Œå› æ­¤è¿”å› nullã€‚
     */
    public ListNode getIntersectionNode(ListNode headA, ListNode headB) {
        ListNode node1 = headA, node2 = headB;
        while (node1 != node2) {
            //è¿™é‡Œwhileçš„åˆ¤æ–­æ¡ä»¶æ±‡æ€»äº†Yçš„æ‰€æœ‰æƒ…å†µ
            //1.Yé€€åŒ–ä¸º\ /ï¼Œå³ä¸å­˜åœ¨å…¬å…±èŠ‚ç‚¹ï¼Œæ­¤æ—¶æœ€ç»ˆç¦»å¼€å¾ªç¯æ—¶,node1=node2=null,ä¸¤é“¾è¡¨Aï¼ŒBé•¿åº¦ç›¸åŒæ—¶ï¼Œnode1,node2åªè¦åˆ†åˆ«éå†å®Œè‡ªå·±çš„é‚£æ¡é“¾è¡¨å°±è¡Œ; ä¸¤é“¾è¡¨é•¿åº¦ä¸åŒæ—¶,node1å…ˆéå†Aé“¾è¡¨,å†éå†Bé“¾è¡¨,node2å…ˆéå†Bé“¾è¡¨,å†éå†Aé“¾è¡¨,ç”±äºAé“¾è¡¨+Bé“¾è¡¨é•¿åº¦å›ºå®šï¼Œç­‰ä»·äºnode1,node2åˆ†åˆ«éå†ä¸€æ¡é•¿åº¦ä¸ºA+Bçš„é“¾è¡¨ï¼Œæœ€ç»ˆä¸€èµ·æŒ‡å‘nullï¼Œå¾ªç¯ç»“æŸï¼›
            //2.Yä¸¤åˆ†å‰é•¿åº¦ä¸€è‡´æ—¶ï¼Œå³A Bé“¾è¡¨é•¿åº¦ç›¸åŒä¸”å­˜åœ¨å…¬å…±èŠ‚ç‚¹ï¼Œæ­¤æ—¶ï¼Œä¸ç­‰node1èµ°å®ŒAé“¾è¡¨(node2èµ°å®ŒBé“¾è¡¨)å³å¯è·å¾—å…¬å…±èŠ‚ç‚¹;
            //3.Yä¸¤åˆ†å‰ä¸åŒä¸”å­˜åœ¨å…¬å…±èŠ‚ç‚¹æ—¶ï¼Œæ­¤æ—¶å³ä¸ºæœ€å¼€å§‹åˆ†ææ—¶çš„æ€è·¯ï¼Œnode1,node2åˆ†åˆ«èµ°å®ŒYçš„æ‰€æœ‰é•¿åº¦ï¼Œå¹¶åœ¨èŠ‚ç‚¹å¤„ç›¸é‡ã€‚
            node1 = node1 == null ? headB : node1.next;
            node2 = node2 == null ? headA : node2.next;
        }
        return node1;
    }

    /**
     * å‰‘æŒ‡ Offer 53 - I. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾æ•°å­— I
     * ç»Ÿè®¡ä¸€ä¸ªæ•°å­—åœ¨æ’åºæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚
     * <p>
     * ç¤ºä¾‹ 1:
     * è¾“å…¥: nums = [5,7,7,8,8,10], target = 8
     * è¾“å‡º: 2
     * <p>
     * ç¤ºä¾‹ 2:
     * è¾“å…¥: nums = [5,7,7,8,8,10], target = 6
     * è¾“å‡º: 0
     */
    public int search(int[] nums, int target) {
        int res = 0;
        for (int num : nums) {
            if (num == target) {
                res++;
            }
        }
        return res;
    }

    /**
     * å‰‘æŒ‡ Offer 53 - II. 0ï½n-1ä¸­ç¼ºå¤±çš„æ•°å­—
     * ä¸€ä¸ªé•¿åº¦ä¸ºn-1çš„é€’å¢æ’åºæ•°ç»„ä¸­çš„æ‰€æœ‰æ•°å­—éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”æ¯ä¸ªæ•°å­—éƒ½åœ¨èŒƒå›´0ï½n-1ä¹‹å†…ã€‚åœ¨èŒƒå›´0ï½n-1å†…çš„nä¸ªæ•°å­—ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ•°å­—ä¸åœ¨è¯¥æ•°ç»„ä¸­ï¼Œè¯·æ‰¾å‡ºè¿™ä¸ªæ•°å­—ã€‚
     * ç¤ºä¾‹ 1:
     * è¾“å…¥: [0,1,3]
     * è¾“å‡º: 2
     * <p>
     * ç¤ºä¾‹ 2:
     * è¾“å…¥: [0,1,2,3,4,5,6,7,9]
     * è¾“å‡º: 8
     */
    public int missingNumber(int[] nums) {
        int i = 0, j = nums.length - 1;
        while (i <= j) {
            int m = (i + j) / 2;
            if (nums[m] == m) i = m + 1;
            else j = m - 1;
        }
        return i;
    }

    /**
     * å‰‘æŒ‡ Offer 54. äºŒå‰æœç´¢æ ‘çš„ç¬¬kå¤§èŠ‚ç‚¹
     * ç»™å®šä¸€æ£µäºŒå‰æœç´¢æ ‘ï¼Œè¯·æ‰¾å‡ºå…¶ä¸­ç¬¬kå¤§çš„èŠ‚ç‚¹ã€‚
     * <p>
     * ç¤ºä¾‹ 1:
     * è¾“å…¥: root = [3,1,4,null,2], k = 1
     * 3
     * / \
     * 1   4
     * \
     * 2
     * è¾“å‡º: 4
     * <p>
     * ç¤ºä¾‹ 2:
     * è¾“å…¥: root = [5,3,6,2,4,null,null,1], k = 3
     * 5
     * / \
     * 3   6
     * / \
     * 2   4
     * /
     * 1
     * è¾“å‡º: 4
     */
    public int kthLargest(TreeNode root, int k) {
        this.k = k;
        dfs(root);
        return res;
    }

    int res, k;

    public void dfs(TreeNode root) {
        if (root == null) return;
        dfs(root.right);
        if (k == 0) return;
        if (--k == 0) res = root.val;
        dfs(root.left);
    }

    /**
     * å‰‘æŒ‡ Offer 55 - I. äºŒå‰æ ‘çš„æ·±åº¦
     * è¾“å…¥ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œæ±‚è¯¥æ ‘çš„æ·±åº¦ã€‚ä»æ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹ä¾æ¬¡ç»è¿‡çš„èŠ‚ç‚¹ï¼ˆå«æ ¹ã€å¶èŠ‚ç‚¹ï¼‰å½¢æˆæ ‘çš„ä¸€æ¡è·¯å¾„ï¼Œæœ€é•¿è·¯å¾„çš„é•¿åº¦ä¸ºæ ‘çš„æ·±åº¦ã€‚
     * ä¾‹å¦‚ï¼š
     * ç»™å®šäºŒå‰æ ‘ [3,9,20,null,null,15,7]ï¼Œ
     * 3
     * / \
     * 9  20
     * /  \
     * 15   7
     * è¿”å›å®ƒçš„æœ€å¤§æ·±åº¦ 3 ã€‚
     */
    public int maxDepth(TreeNode root) {
        return root == null ? 0 : Math.max(maxDepth(root.left), maxDepth(root.right)) + 1;
    }

    /**
     * å‰‘æŒ‡ Offer 55 - II. å¹³è¡¡äºŒå‰æ ‘
     * è¾“å…¥ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œåˆ¤æ–­è¯¥æ ‘æ˜¯ä¸æ˜¯å¹³è¡¡äºŒå‰æ ‘ã€‚å¦‚æœæŸäºŒå‰æ ‘ä¸­ä»»æ„èŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„æ·±åº¦ç›¸å·®ä¸è¶…è¿‡1ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚
     * <p>
     * ç¤ºä¾‹ 1:
     * ç»™å®šäºŒå‰æ ‘ [3,9,20,null,null,15,7]
     * <p>
     * 3
     * / \
     * 9  20
     * /  \
     * 15   7
     * è¿”å› true ã€‚
     * <p>
     * ç¤ºä¾‹ 2:
     * ç»™å®šäºŒå‰æ ‘ [1,2,2,3,3,null,null,4,4]
     * <p>
     * 1
     * / \
     * 2   2
     * / \
     * 3   3
     * / \
     * 4   4
     * è¿”å› false ã€‚
     */
    public boolean isBalanced(TreeNode root) {
        return recur(root) != -1;
    }

    private int recur(TreeNode root) {
        if (root == null) return 0;
        int left = recur(root.left);
        if (left == -1) return -1;
        int right = recur(root.right);
        if (right == -1) return -1;
        return Math.abs(left - right) < 2 ? Math.max(left, right) + 1 : -1;
    }

    /**
     * å‰‘æŒ‡ Offer 57. å’Œä¸ºsçš„ä¸¤ä¸ªæ•°å­—
     * è¾“å…¥ä¸€ä¸ªé€’å¢æ’åºçš„æ•°ç»„å’Œä¸€ä¸ªæ•°å­—sï¼Œåœ¨æ•°ç»„ä¸­æŸ¥æ‰¾ä¸¤ä¸ªæ•°ï¼Œä½¿å¾—å®ƒä»¬çš„å’Œæ­£å¥½æ˜¯sã€‚å¦‚æœæœ‰å¤šå¯¹æ•°å­—çš„å’Œç­‰äºsï¼Œåˆ™è¾“å‡ºä»»æ„ä¸€å¯¹å³å¯ã€‚
     * ç¤ºä¾‹ 1ï¼š
     * è¾“å…¥ï¼šnums = [2,7,11,15], target = 9
     * è¾“å‡ºï¼š[2,7] æˆ–è€… [7,2]
     * <p>
     * ç¤ºä¾‹ 2ï¼š
     * è¾“å…¥ï¼šnums = [10,26,30,31,47,60], target = 40
     * è¾“å‡ºï¼š[10,30] æˆ–è€… [30,10]
     */
    public int[] twoSum(int[] nums, int target) {
        int i = 0, j = nums.length - 1;
        while (i < j) {
            int s = nums[i] + nums[j];
            if (s < target) i++;
            else if (s > target) j--;
            else return new int[]{nums[i], nums[j]};
        }
        return new int[0];
    }

    /**
     * å‰‘æŒ‡ Offer 57 - II. å’Œä¸ºsçš„è¿ç»­æ­£æ•°åºåˆ—
     * è¾“å…¥ä¸€ä¸ªæ­£æ•´æ•° target ï¼Œè¾“å‡ºæ‰€æœ‰å’Œä¸º target çš„è¿ç»­æ­£æ•´æ•°åºåˆ—ï¼ˆè‡³å°‘å«æœ‰ä¸¤ä¸ªæ•°ï¼‰ã€‚
     * åºåˆ—å†…çš„æ•°å­—ç”±å°åˆ°å¤§æ’åˆ—ï¼Œä¸åŒåºåˆ—æŒ‰ç…§é¦–ä¸ªæ•°å­—ä»å°åˆ°å¤§æ’åˆ—ã€‚
     * <p>
     * ç¤ºä¾‹ 1ï¼š
     * è¾“å…¥ï¼štarget = 9
     * è¾“å‡ºï¼š[[2,3,4],[4,5]]
     * <p>
     * ç¤ºä¾‹ 2ï¼š
     * è¾“å…¥ï¼štarget = 15
     * è¾“å‡ºï¼š[[1,2,3,4,5],[4,5,6],[7,8]]
     */
    public int[][] findContinuousSequence(int target) {
        List<int[]> list = new ArrayList<>();
        //ğŸ§ é‡Œè¦æœ‰ä¸€ä¸ªåŒºé—´çš„æ¦‚å¿µï¼Œè¿™é‡Œçš„åŒºé—´æ˜¯(1, 2, 3, ..., target - 1)
        //å¥—æ»‘åŠ¨çª—å£æ¨¡æ¿ï¼Œlæ˜¯çª—å£å·¦è¾¹ç•Œï¼Œræ˜¯çª—å£å³è¾¹ç•Œï¼Œçª—å£ä¸­çš„å€¼ä¸€å®šæ˜¯è¿ç»­å€¼ã€‚
        //å½“çª—å£ä¸­æ•°å­—å’Œå°äºtargetæ—¶ï¼Œrå³ç§»; å¤§äºtargetæ—¶ï¼Œlå³ç§»; ç­‰äºtargetæ—¶å°±è·å¾—äº†ä¸€ä¸ªè§£
        for (int l = 1, r = 1, sum = 0; r < target; r++) {
            sum += r;
            while (sum > target) {
                sum -= l++;
            }
            if (sum == target) {
                int[] temp = new int[r - l + 1];
                for (int i = 0; i < temp.length; i++) {
                    temp[i] = l + i;
                }
                list.add(temp);
            }
        }

        int[][] res = new int[list.size()][];
        for (int i = 0; i < res.length; i++) {
            res[i] = list.get(i);
        }
        return res;
    }

    /**
     * å‰‘æŒ‡ Offer 58 - I. ç¿»è½¬å•è¯é¡ºåº
     * è¾“å…¥ä¸€ä¸ªè‹±æ–‡å¥å­ï¼Œç¿»è½¬å¥å­ä¸­å•è¯çš„é¡ºåºï¼Œä½†å•è¯å†…å­—ç¬¦çš„é¡ºåºä¸å˜ã€‚ä¸ºç®€å•èµ·è§ï¼Œæ ‡ç‚¹ç¬¦å·å’Œæ™®é€šå­—æ¯ä¸€æ ·å¤„ç†ã€‚ä¾‹å¦‚è¾“å…¥å­—ç¬¦ä¸²"I am a student. "ï¼Œåˆ™è¾“å‡º"student. a am I"ã€‚
     * <p>
     * ç¤ºä¾‹ 1ï¼š
     * è¾“å…¥: "the sky is blue"
     * è¾“å‡º: "blue is sky the"
     * <p>
     * ç¤ºä¾‹ 2ï¼š
     * è¾“å…¥: "  hello world!  "
     * è¾“å‡º: "world! hello"
     * è§£é‡Š: è¾“å…¥å­—ç¬¦ä¸²å¯ä»¥åœ¨å‰é¢æˆ–è€…åé¢åŒ…å«å¤šä½™çš„ç©ºæ ¼ï¼Œä½†æ˜¯åè½¬åçš„å­—ç¬¦ä¸èƒ½åŒ…æ‹¬ã€‚
     * <p>
     * ç¤ºä¾‹ 3ï¼š
     * è¾“å…¥: "a good   example"
     * è¾“å‡º: "example good a"
     * è§£é‡Š: å¦‚æœä¸¤ä¸ªå•è¯é—´æœ‰å¤šä½™çš„ç©ºæ ¼ï¼Œå°†åè½¬åå•è¯é—´çš„ç©ºæ ¼å‡å°‘åˆ°åªå«ä¸€ä¸ªã€‚
     */
    public String reverseWords(String s) {
        String[] ss = s.split(" ");
        StringBuilder sb = new StringBuilder();
        for (int i = ss.length - 1; i >= 0; i--) {
            if (!"".equals(ss[i])) {
                sb.append(ss[i]).append(" ");
            }
        }
        return sb.toString().trim();
    }
}
